# DART Financial Data Analyzer (다트 재무데이터 분석기)

Open DART API를 활용하여 기업의 재무제표(매출액, 영업이익) 데이터를 수집, 분석하고 엑셀로 저장하는 파이썬 도구입니다.

특히 **4분기 누적 데이터에서 4분기 개별 실적을 산출하는 보정 기능**을 포함하여 보다 정확한 분기별 추이를 확인할 수 있습니다.

## 📌 주요 기능

- **기업 검색**: 회사명으로 DART 고유번호를 검색 (정확/부분 일치 지원)
- **재무 데이터 수집**: 
  - 매출액(Revenue) 및 영업이익(Operating Income) 자동 추출
  - 연결/별도 재무제표 모두 지원
- **4분기 데이터 보정**: 사업보고서(연간 누적) 데이터에서 1~3분기 데이터를 차감하여 실제 4분기 실적 계산
- **시각화 테이블**: 터미널에서 깔끔한 표 형태로 재무 정보 및 영업이익률 확인
- **엑셀 저장**: 분석된 데이터를 Excel 파일로 자동 저장

## 🛠 선행 조건 (Prerequisites)

이 프로젝트를 실행하기 위해서는 다음이 필요합니다:
- Python 3.8 이상
- [Open DART API 키](https://opendart.fss.or.kr/) (무료 발급 가능)

## 📦 설치 방법 (Installation)

1. 저장소를 클론합니다.
   ```bash
   git clone https://github.com/yourusername/dart-financial-analyzer.git
   cd dart-financial-analyzer
   ```

2. 필요한 라이브러리를 설치합니다.
   ```bash
   pip install requests pandas openpyxl python-dotenv
   ```

## ⚙️ 설정 (Configuration)

프로젝트 루트 디렉토리에 `.env` 파일을 생성하고 발급받은 DART API 키를 입력하세요.

**`.env` 파일 예시:**
```env
DART_API_KEY=your_api_key_here_12345678
```

## 🚀 사용 방법 (Usage)

터미널에서 스크립트를 실행합니다.

```bash
python dart_api_test.py
```

### 실행 흐름 예시

1. **회사명 입력**: 검색할 회사 이름 (예: `삼성전자`)
2. **기간 입력**: 
   - `YYYY`: 해당 연도의 모든 분기 데이터 조회 (예: `2024`)
   - `YYYYMM`: 해당 분기를 기준으로 과거 4개 분기 추이 조회 (예: `202409`)
3. **결과 확인**: 터미널에 출력된 요약 테이블 확인 및 생성된 엑셀 파일 확인

### 출력 예시

```
🏢 검색할 회사명을 입력하세요 (종료: q): 삼성전자
📅 조회할 연도 또는 YYYYMM을 입력하세요 (기본값: 2024): 2024

... (데이터 수집 로그) ...

                         📋 [재무 정보 요약 테이블]
================================================================================
기간         |        매출액 |      영업이익 |    영업이익률 |        단위
--------------------------------------------------------------------------------
2024년 1분기 | 71,915,600 | 6,606,000 |     9.19 |         원
2024년 2분기 | 74,068,300 | 10,443,600 |    14.10 |         원
2024년 3분기 | 79,098,700 | 9,183,400 |    11.61 |         원
--------------------------------------------------------------------------------

💾 엑셀 파일 저장 완료: 005930_2024_전체분기_재무정보.xlsx
```

## 📂 파일 구조

- `dart_api_test.py`: 메인 소스 코드
- `company_codes_cache.json`: DART 기업 고유번호 캐시 파일 (최초 실행 시 자동 생성)
- `.env`: API 키 설정 파일 (사용자가 생성 필요)

## ⚠️ 주의사항

- Open DART API는 일일 요청 횟수 제한이 있을 수 있습니다.
- 4분기 보정 값은 1~3분기 데이터가 모두 존재해야 정확하게 계산됩니다.

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.